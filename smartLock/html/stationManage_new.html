<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>智能锁管理平台</title>
    <style type="text/css">
        .screen-top{
            padding:8px 0;
            background-color:#f6f6f6;
        }
        .screen-top span{
            width: 100px !important;
            text-align: center !important;
            font-size:16px;
            padding-left:15px;
            margin-bottom: 3px;
        }
        .screen-top span input{
            margin-left: 20px;
            padding: 6px;
            font-size: 13px;
            background: #fff url('../assets/images/bg-form-field.gif') top left repeat-x;
            border: 1px solid #d5d5d5;
            color: #333;
            width: 15% !important;
        }
        #createStationFieldSet strong{
            width: 120px;
            line-height: 30px;
            display: inline-block;
            text-align: left;
        }
    </style>
    <!--CSS-->
    <script type="text/javascript" src="../assets/js/jquery-1.8.0.min.js"></script>

    <!--bootstrap-->
    <link type="text/css" rel="stylesheet" media="all" href="../assets/css/bootstrap.css">
    <!-- Reset Stylesheet -->
    <link rel="stylesheet" href="../assets/css/reset.css" type="text/css" media="screen" />
    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="../assets/css/style_new.css" type="text/css" media="screen" />
    <!-- Invalid Stylesheet. This makes stuff look pretty. Remove it if you want the CSS completely valid -->
    <link rel="stylesheet" href="../assets/css/invalid.css" type="text/css" media="screen" />
    <!-- Colour Schemes  -->
    <!--Default colour scheme is green. Uncomment prefered stylesheet to use it.-->
    <!--<link rel="stylesheet" href="../assets/css/blue.css" type="text/css" media="screen" />-->
    <!--<link rel="stylesheet" href="../assets/css/red.css" type="text/ css" media="screen" />-->
    <!-- Internet Explorer Fixes Stylesheet -->
    <!--[if lte IE 7]>
    <link rel="stylesheet" href="../assets/css/ie.css" type="text/css" media="screen" />
    <![endif]-->
    <!--JqueryDateTable-->
    <link rel="stylesheet" href="../assets/css/jquery.dataTables.min.css"/>
    <script type="text/javascript" src="../assets/js/jquery.dataTables.min.js"></script>
    <!-- SweetAlert-->
    <script type="text/javascript" src="../assets/js/sweet-alert.min.js"></script>
    <link rel="stylesheet" href="../assets/css/sweet-alert.css"/>
    <!-- jQuery -->
    <!-- jQuery Configuration -->
    <script type="text/javascript" src="../assets/js/simpla.jquery.configuration.js"></script>
    <script type="text/javascript" src="../assets/js/pccs.js"></script>
    <!-- / flatty theme -->
    <link type="text/css" rel="stylesheet" media="all" id="color-settings-body-color" href="../assets/css/light-theme.css">
    <!-- jQuery Date Plugin -->
    <!--[if IE]><script type="text/javascript" src="../assets/js/jquery.bgiframe.js"></script><![endif]-->
    <!-- Internet Explorer .png-fix -->
    <!--[if IE 6]> -->
    <script type="text/javascript" src="../assets/js/DD_belatedPNG_0.0.7a.js"></script>
    <script type="text/javascript">
        DD_belatedPNG.fix('.png_bg, img, li');
    </script>
    <style type="text/css">
        #wrapper #logo {
            margin: 20px 5px;
        }
        #wrapper #profile-links {
            padding: 0 15px 20px 15px;
            line-height: 1.5em;
            text-align: right;
        }
        #wrapper {
            background: #f0f0f0 url('../assets/images/sidebar_bg.gif') top left repeat-y;
            color: #888;
            font-size: 14px;
            height: 100%;
            left: 0;
            position: absolute;
            top: 0;
            width: 230px;
            border-right: 1px solid #dddddd;
        }
        #main-content {
            margin: 0 30px 0 260px;
            padding: 40px 0 0;
        }
        body {
            color: #555;
            font-family: Arial,Helvetica,sans-serif;
            font-size: 12px;
        }
        #wrapper a, a:hover, .btn-link, .btn-link:hover {
            color: #222222;
            text-shadow: none;
        }
        #footer a{
            color: #57a000;
            text-decoration: none;
        }


    </style><!--更改页面风格自定义CSS-->
    <![endif]-->
    <!--编辑框开始-->
    <!-- dialog Stylesheet -->
    <link href="../assets/css/dialog.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript">
        $(document).ready(function() {
            $("#cancel_editStationInfo").click(function(event) {
                $(".popBox[title=editOneStationInfo] input").val("");
                $(".model-bg[title=editOneStationInfo],.popBox[title=editOneStationInfo]").hide();
            });
            $(".clsBtn[title=editOneStationInfo]").click(function(event) {
                $(".model-bg[title=editOneStationInfo],.popBox[title=editOneStationInfo]").hide();
            });
        });
        //个人资料编辑框控制
        $(document).ready(function(){
            $("#cancel_editPerson").click(function(event) {
                $(".popBox[title=editPersonInfo] input").val("");
                $(".model-bg[title=editPersonInfo],.popBox[title=editPersonInfo]").hide();
            });
            $(".clsBtn[title=editPersonInfo]").click(function(event) {
                $(".model-bg[title=editPersonInfo],.popBox[title=editPersonInfo]").hide();
            });
        });
        //个人资料编辑交互方法控制
        $(document).ready(function(){
            /**
             * 点击修改个人资料
             */
            $(".mode2").click(function(){
                //获取原始数据
                var username = userInfo.username;
                var userType = userInfo.userType;
                var company = userInfo.company;
                var phone = userInfo.phone;
                //将数据预填入编辑框
                $("#editPerson_username").val(username);
                var displayUserType="";
                if(userType!=""||userType!=null){
                    switch(userType[0]){
                        case "1":
                            displayUserType="铁塔公司";
                            switch (userType[1]){
                                case "0":
                                    displayUserType+="省级";
                                    break;
                                case "1":
                                    displayUserType+="市级"
                                    break;
                                case "2":
                                    displayUserType+="县区级";
                                    break;
                            }
                            switch (userType[2]){
                                case "1":
                                    displayUserType+="管理员";
                                    break;
                                case "2":
                                    displayUserType+="审批员";
                                    break;
                                case "3":
                                    displayUserType+="工程师";
                                    break;
                            }
                            break;
                        case "2":
                            displayUserType="中国移动";
                            switch (userType[1]){
                                case "0":
                                    displayUserType+="省级";
                                    break;
                                case "1":
                                    displayUserType+="市级"
                                    break;
                                case "2":
                                    displayUserType+="县区级";
                                    break;
                            }
                            switch (userType[2]){
                                case "1":
                                    displayUserType+="管理员";
                                    break;
                                case "2":
                                    displayUserType+="审批员";
                                    break;
                                case "3":
                                    displayUserType+="工程师";
                                    break;
                            }
                            break;
                        case "3":
                            displayUserType="中国联通";
                            switch (userType[1]){
                                case "0":
                                    displayUserType+="省级";
                                    break;
                                case "1":
                                    displayUserType+="市级"
                                    break;
                                case "2":
                                    displayUserType+="县区级";
                                    break;
                            }
                            switch (userType[2]){
                                case "1":
                                    displayUserType+="管理员";
                                    break;
                                case "2":
                                    displayUserType+="审批员";
                                    break;
                                case "3":
                                    displayUserType+="工程师";
                                    break;
                            }
                            break;
                        case "4":
                            displayUserType="中国电信";
                            switch (userType[1]){
                                case "0":
                                    displayUserType+="省级";
                                    break;
                                case "1":
                                    displayUserType+="市级"
                                    break;
                                case "2":
                                    displayUserType+="县区级";
                                    break;
                            }
                            switch (userType[2]){
                                case "1":
                                    displayUserType+="管理员";
                                    break;
                                case "2":
                                    displayUserType+="审批员";
                                    break;
                                case "3":
                                    displayUserType+="工程师";
                                    break;
                            }
                            break;
                        case "5":
                            displayUserType="施工公司";
                            switch (userType[2]){
                                case "1":
                                    displayUserType+="管理员";
                                    break;
                                case "2":
                                    displayUserType+="审批员";
                                    break;
                                case "3":
                                    displayUserType+="工程师";
                                    break;
                            }
                            break;
                        case "6":
                            displayUserType="代维公司";
                            switch (userType[2]){
                                case "1":
                                    displayUserType+="管理员";
                                    break;
                                case "2":
                                    displayUserType+="审批员";
                                    break;
                                case "3":
                                    displayUserType+="工程师";
                                    break;
                            }
                            break;
                        case "7":
                            displayUserType="厂商";
                            switch (userType[2]){
                                case "1":
                                    displayUserType+="管理员";
                                    break;
                                case "2":
                                    displayUserType+="审批员";
                                    break;
                                case "3":
                                    displayUserType+="工程师";
                                    break;
                            }
                            break;
                    }

                }
                if (displayUserType!=""){
                    $("#editPerson_userType").val(displayUserType);
                }
                $("#editPerson_company").val(company);
                $("#editPerson_phone").val(phone);
                $(".model-bg[title=editPersonInfo],.popBox[title=editPersonInfo]").show();
            });
            /**
             * 修改个人资料，提交
             */
            $("#submit_editPerson").click(function(){
                //获取公共字段
                var originalPhone = userInfo.phone;
                var originalPassword = localStorage.getItem("originalPassword");
                var operatorName=userInfo.username;
                var qsData="operatorName="+operatorName+"&accessToken="+accessToken+"&originalName="+operatorName;
                var updatePersonInfo = "";
                //获取编辑数据
//                var phone = $("#editPerson_phone").val();
                var password = $("#editPerson_originalPassword").val();
                var newPassword1 = $("#editPerson_newPassword1").val();
                var newPassword2 = $("#editPerson_newPassword2").val();
                if(password!=originalPassword){
                    alert("原始密码不正确，请重新输入！");
                    $("#editPerson_originalPassword").val("");
                    $("#editPerson_originalPassword").focus();
                    return;
                }else if(newPassword1==""||newPassword2==""){
                    $("#editPerson_newPassword1").focus();
                    alert("输入参数为空，请重新输入！");
                    return;
                }else if(newPassword1!=newPassword2){
                    alert("两次输入密码不一致，请重新输入！");
                    $("#editPerson_newPassword1").val("");
                    $("#editPerson_newPassword2").val("");
                    $("#editPerson_newPassword1").focus();
                    return;
                }else{
                    updatePersonInfo+="&password="+newPassword1;
                }
                if(updatePersonInfo==""){
                    alert("输入参数为空，请重新输入！");
                    $("#editPerson_newPassword1").focus();
                    return;
                }else{
                    qsData+=updatePersonInfo;
                }
                //发起请求
                $.ajax({
                    async: false,
                    url: "https://www.smartlock.top/v0/updateUser",
                    type: "POST",
                    contentType: "application/x-www-form-urlencoded",
                    data: qsData,
                    timeout: 8000,
                    beforeSend: function ()
                    {

                    },
                    success: function (result) {

                        //将返回数据转化为json格式数据
                        var infoJson =JSON.parse(result);
                        //判断查询是否成功
                        if (infoJson.error){
                            var errInfo = infoJson.error;
                            alert(errInfo.msg);
                            if(errInfo.code=="00000"){
                                window.location.href="login.html";
                            }
                        }else if (infoJson.success)
                        {
                            var sucInfo =  infoJson.success;
                            var msg = sucInfo.msg;
                            alert(msg);
                            $(".edit-panel[title=editPersonInfo] input").val("");
                            $(".model-bg[title=editPersonInfo],.edit-panel[title=editPersonInfo]").hide();
                            if(sucInfo.code=="04000"){
                                window.location.href="login.html";
                            }
                        }else {
                            alert("未知错误，请联系管理员！")
                        }
                    },
                    error: function (result) {
                        console.log(result);
                        alert("无法连接到服务器！");
                    }
                });
            });
        });
    </script>
    <!--编辑框结束-->
    <script type="text/javascript">
        //全局定义变量
        var table;
        var userInfo=JSON.parse(localStorage.getItem("userInfo"));
        var tokenEndTime=localStorage.getItem("tokenEndTime");
        var originalStationID = "";

        /**
         * datables初始化
         */
        $(document).ready(function() {
            //新建基站
            table = $('#stationInfo').DataTable( {
                "searching": false,
                "bStateSave": false,
                "aoColumns": [
                    {
                        "data":"_id",
                        "orderable": false,
                        "render": function(data, type, full, meta) {
                            return data = '<input type="checkbox" id="checkbox" value="'+data+'" title="'+data+'"/>';

                        }
                    },
                    {
                        "data": "stationID",
                        "sClass" : "center"
                    },
                    { "data": "address" },
                    {
                        "data": "doorStatus" ,
                        "render": function(data, type, full, meta) {
                            if (data =="closed" ) {
                                data = "<font color='red'>关闭状态</font>";
                            } else {
                                data = "<font color='#67a81a'>开启状态</font>";
                            }
                            return data;
                        }
                    }
                    ,
                    {
                        "data":"lockID",
                    },
                    { "data": "chargePerson" },
//                    { "data": "chargePhone" },
//                    { "data": "chargeCompany" },
                    {
                        "data":"managementProvince",
                        "bVisible" : false
                    },
                    {
                        "data":"managementCity",
                        "bVisible" : false
                    },{
                        "data":"managementArea",
                        "bVisible" : false
                    },
                    {"data":"approvalPerson",},
//                    {"data":"approvalPhone",},
                    {
                        "data":"_id",
                        "render": function(data, type, full, meta) {
                            return data = '<a href="#" id="deleteOne" title="Delete"><img src="../assets/images/icons/cross.png" alt="Delete" /></a>' +
                                    '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' +
                                    '<a href="#" id="stationEdit" title="stationEdit" class="model"><img src="../assets/images/icons/pencil.png" alt="Edit"/></a>';

                        }
                    }
                ],
                language: {
                    "sProcessing": "处理中...",
                    "sLengthMenu": "显示 _MENU_ 项结果",
                    "sZeroRecords": "没有匹配结果",
                    "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
                    "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
                    "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
                    "sInfoPostFix": "",
                    "sSearch": "搜索:",
                    "sUrl": "",
                    "sEmptyTable": "表中数据为空",
                    "sLoadingRecords": "载入中...",
                    "sInfoThousands": ",",
                    "oPaginate": {
                        "sFirst": "首页",
                        "sPrevious": "上页",
                        "sNext": "下页",
                        "sLast": "末页"
                    },
                    "oAria": {
                        "sSortAscending": ": 以升序排列此列",
                        "sSortDescending": ": 以降序排列此列"
                    }
                },
            })
        } );

        /**
         * 按钮点击功能
         */
        $(document).ready(function(){
            $("input#allcheck").click(function(){
                if(this.checked){
                    $("#stationInfo tbody tr").each(function(){
                        if(!$(this).hasClass("checked")){
                            $(this).click();
                        }
                    })
                }else {
                    $('#example tbody tr').click();
                }
            });
            /**
             * 导出xls功能
             */
            $(".button[id=exportxls]").click(function(){
                var qsData = collectQueryInfo();
//                console.log("导出excel的条件为："+qsData);
                //发起请求
                $.ajax({
                    async: false,
                    url: "https://www.smartlock.top/v0/downloadStation",
                    type: "POST",
                    contentType: "application/x-www-form-urlencoded",
                    data: qsData,
                    timeout: 8000,
                    beforeSend: function ()
                    {

                    },
                    success: function (result) {

                        //将返回数据转化为json格式数据
                        var infoJson =JSON.parse(result);

                        //判断查询是否成功
                        if (infoJson.error){
                            var errInfo = infoJson.error;
                            alert(errInfo.msg);
                            if(errInfo.code=="00000"){
                                window.location.href="login.html";
                            };
                            reset();
                            return;
                        }else if (infoJson.success)
                        {
                            alert("后台已经生成数据，请进行下载！");
                            var sucInfo =  infoJson.success;
                            var downloadUrl = sucInfo.url;
                            reset();
                            window.open(downloadUrl);
                        }else {
                            alert("未知错误，请联系管理员！")
                        }


                    },
                    error: function (result) {
//                        console.log(result);
                        alert("无法连接到服务器！");
                    }
                });
            });
            /**
             * 点击删除按钮
             */
            $(".button[id=delete]").click(function()
            {
                var bool=window.confirm('你确认要删除选中数据？');
                if(bool==false)
                {
                    return;
                }

                var theArray = [];
                var a = table.rows('.selected').data();
                for(var i=0;i< a.length;i++){
                    var stationID = a[i].stationID;
                    theArray.push(stationID)
                };
//                console.log(theArray.toString());
                if(theArray.length<1){
                    alert("请至少选择一个进行操作！")
                }else {
                    alert("所选中的数据为："+theArray.toString())

                    //获取参数
                    var operatorName=userInfo.username;
                    var qsData="operatorName="+operatorName+"&accessToken="+accessToken+"&deleteList="+theArray;
//                    console.log("删除请求字段为："+qsData);
                    //发起请求
                    $.ajax({
                        async: false,
                        url: "https://www.smartlock.top/v0/deleteStation",
                        type: "POST",
                        contentType: "application/x-www-form-urlencoded",
                        data: qsData,
                        timeout: 8000,
                        beforeSend: function ()
                        {

                        },
                        success: function (result) {

                            //将返回数据转化为json格式数据
                            var infoJson =JSON.parse(result);

                            //判断查询是否成功
                            if (infoJson.error){
                                var errInfo = infoJson.error;
                                alert(errInfo.msg);
                                if(errInfo.code=="00000"){
                                    window.location.href="login.html";
                                };
                                return;
                            }else if (infoJson.success)
                            {
                                var sucInfo =  infoJson.success;
                                var msg = sucInfo.msg;
                                alert(msg);

//                                table.row('.selected').remove().draw( false );
                            }else {
                                alert("未知错误，请联系管理员！")
                            }

                            window.location.href='https://www.smartlock.top/my_smartlock/html/stationManage_new.html';

                        },
                        error: function (result) {
//                            console.log(result);
                            alert("无法连接到服务器！");
                        }

                    });

                };
            });
            //带标题的
            /**
             * 多选选中和取消选中,同时选中第一个单元格单选框,并联动全选单选框
             */
            $('#stationInfo tbody').on('click', 'tr', function(event) {
                var allChecked = $('input[name=allChecked]')[0]; //关联全选单选框
                $($(this).children()[0]).children().each(function() {
                    if (this.type == "checkbox" && (!$(event.target).is(":checkbox") && $(":checkbox", this).trigger("click"))) {
                        if (!this.checked) {
                            this.checked = true;
                            addValue(this);
                            var selected = table.rows('.selected').data().length; //被选中的行数
                            //全选单选框的状态处理
                            var recordsDisplay = table.page.info().recordsDisplay; //搜索条件过滤后的总行数
                            var iDisplayStart = table.page.info().start; // 起始行数
                            if (selected === table.page.len() || selected === recordsDisplay || selected === (recordsDisplay - iDisplayStart)) {
                                allChecked.checked = true;
                            }
                        } else {
                            this.checked = false;
                            cancelValue(this);
                            allChecked.checked = false;
                        }
                    }
                });
                $(this).toggleClass('selected'); //放在最后处理，以便给checkbox做检测
            });
            /**
             * 单选框被选中时将它的value放入隐藏域
             */
            function addValue(para) {
                var userIds = $("input[name=id]");
                if (userIds.val() === "") {
                    userIds.val($(para).val());
                } else {
                    userIds.val(userIds.val() + "," + $(para).val());
                }
            };
            /**
             * 单选框取消选中时将它的value移除隐藏域
             */
            function cancelValue(para) {
                //取消选中checkbox要做的操作
                var userIds = $("input[name=allChecked]");
                var array = userIds.val().split(",");
                userIds.val("");
                for (var i = 0; i < array.length; i++) {
                    if (array[i] === $(para).val()) {
                        continue;
                    }
                    if (userIds.val() === "") {
                        userIds.val(array[i]);
                    } else {
                        userIds.val(userIds.val() + "," + array[i]);
                    }
                }
            };
            /**
             * 单行点击编辑按钮
             */
            $('#stationInfo').on('click', '.model', function () {
                //为原始ID进行赋值
                originalStationID=this.parentNode.parentNode.childNodes.item([1]).innerText;
                //获取点击行显示的字段
                var stationID = this.parentNode.parentNode.childNodes.item([1]).innerText;
                var address = this.parentNode.parentNode.childNodes.item([2]).innerText;
                var doorStatus = this.parentNode.parentNode.childNodes.item([3]).innerText;
                var lockID = this.parentNode.parentNode.childNodes.item([4]).innerText;
                var chargePerson = this.parentNode.parentNode.childNodes.item([5]).innerText;
                var chargePhone = this.parentNode.parentNode.childNodes.item([6]).innerText;
                var approvalPerson = this.parentNode.parentNode.childNodes.item([8]).innerText;
                var approvalPhone = this.parentNode.parentNode.childNodes.item([9]).innerText;
                //将获取的字段填入编辑框中
                $("#edit_stationID").val(stationID);
                $("#edit_address").val(address);
                $("#edit_doorStatus").val(doorStatus);
                $("#edit_lockID").val(lockID);
                $("#edit_chargePerson").val(chargePerson);
                $("#edit_approvalPerson").val(approvalPerson);
                //显示编辑窗口
                $(".model-bg[title=editOneStationInfo],.popBox[title=editOneStationInfo]").show();
            } );
            /**
             * 单击编辑窗口提交按钮
             */
            $('#submit_editStationInfo').click(function(event){
                alert("进入提交动作！");
                //获取公共字段
                var operatorName=userInfo.username;
                var qsData="operatorName="+operatorName+"&accessToken="+accessToken+"&originalStationID="+originalStationID;
                var updateStationInfo = "";
                //收集编辑框字段
                var stationID=$("#edit_stationID").val();
                var address = $("#edit_address").val();
                var doorStatus = $("#edit_doorStatus").val();
                var lockID = $("#edit_lockID").val();
                var chargePerson = $("#edit_chargePerson").val();
                var approvalPerson = $("#edit_approvalPerson").val();
                //对字段进行判空
                if(stationID==""||stationID==null){
                    alert("基站编号不能为空，请重新填写！")
                    $("#edit_stationID").focus();
                    return;
                }else{
                    updateStationInfo="&stationID="+stationID;
                }
                if(address==""||address==null){
                    alert("基站地址不能为空，请重新填写！")
                    $("#edit_address").focus()
                    return;
                }else{
                    updateStationInfo +="&address="+address;
                }
                if(doorStatus==""||doorStatus==null){
                        //没有要求，不做判断
                }else{
                    updateStationInfo +="&doorStatus="+doorStatus;
                }
                if(lockID==""||lockID==null){
                    alert("门锁ID不能为空，请重新填写！")
                    $("#edit_lockID").focus()
                    return;
                }else{
                    updateStationInfo +="&lockID="+lockID;
                }
                if(chargePerson==""||chargePerson==null){
                    alert("负责人不能为空，请重新填写！")
                    $("#edit_chargePerson").focus()
                    return;
                }else{
                    updateStationInfo +="&chargePerson="+chargePerson;
                }
                if(approvalPerson==""||approvalPerson==null){
                    alert("作业审批人不能为空，请重新填写！")
                    $("#edit_approvalPerson").focus()
                    return;
                }else{
                    updateStationInfo +="&approvalPerson="+approvalPerson;
                }
                qsData=qsData+updateStationInfo;
//                alert("编辑的提交数据为："+qsData);
//                console.log("编辑的提交数据为："+qsData);
                //发起请求
                $.ajax({
                    async: false,
                    url: "https://www.smartlock.top/v0/updateStation",
                    type: "POST",
                    contentType: "application/x-www-form-urlencoded",
                    data: qsData,
                    timeout: 8000,
                    beforeSend: function ()
                    {

                    },
                    success: function (result) {

                        //将返回数据转化为json格式数据
                        var infoJson =JSON.parse(result);

                        //判断查询是否成功
                        if (infoJson.error){
                            var errInfo = infoJson.error;
                            alert(errInfo.msg);
                            if(errInfo.code=="00000"){
                                window.location.href="login.html";
                            };
                            return;
                        }else if (infoJson.success)
                        {
                            var sucInfo =  infoJson.success;
                            var msg = sucInfo.msg;
                            alert(msg);
                            $(".popBox[title=editOneStationInfo] input").val("");
                            $(".model-bg[title=editOneStationInfo],.popBox[title=editOneStationInfo]").hide();
                            queryStation();
                        }else {
                            alert("未知错误，请联系管理员！")
                        }


                    },
                    error: function (result) {
//                        console.log(result);
                        alert("无法连接到服务器！");
                    }
                });

            });
            /**
             * 单行删除按钮点击事件响应
             */
            $('#stationInfo tbody').on( 'click', '#deleteOne', function () {
                        var bool=window.confirm('你确认要删除选中数据？');
                        if(bool==false)
                        {
                            return;
                        }

                        var theArray = [];
                        var a = this.parentNode.parentNode.childNodes.item([1]).innerHTML;
                        theArray.push(a);

                        var operatorName=userInfo.username;
                        var qsData="operatorName="+operatorName+"&accessToken="+accessToken+"&deleteList="+theArray;
//                                    console.log("删除请求字段为："+qsData);
                        //发起请求
                        $.ajax({
                            async: false,
                            url: "https://www.smartlock.top/v0/deleteStation",
                            type: "POST",
                            contentType: "application/x-www-form-urlencoded",
                            data: qsData,
                            timeout: 8000,
                            beforeSend: function ()
                            {

                            },
                            success: function (result) {

                                //将返回数据转化为json格式数据
                                var infoJson =JSON.parse(result);

                                //判断查询是否成功
                                if (infoJson.error){
                                    var errInfo = infoJson.error;
                                    alert(errInfo.msg);
                                    if(errInfo.code=="00000"){
                                        window.location.href="login.html";
                                    };
                                    return;
                                }else if (infoJson.success)
                                {
                                    var sucInfo =  infoJson.success;
                                    var msg = sucInfo.msg;
                                    alert(msg);
                                    swal(
                                            "已经删除！",
                                            "你操作的数据已经删除！",
                                            "success"
                                    );
                                    table.row('.selected').remove().draw( false );
                                }else {
                                    alert("未知错误，请联系管理员！")
                                }


                            },
                            error: function (result) {
//                                            console.log(result);
                                alert("无法连接到服务器！");
                            }
                        });
                    });

//          alert(a.toString());


        });


    </script>
    <script type="text/javascript">
        var userInfo=JSON.parse(localStorage.getItem("userInfo"));
        var regionInfo=JSON.parse(localStorage.getItem("regionInfo"));
        var permissions=JSON.parse(localStorage.getItem("permissions"));
        var accessToken=localStorage.getItem("accessToken");
        var tokenEndTime=localStorage.getItem("tokenEndTime");
        //检查是否有登录状态
        function  checkUserValidity(){
            if(userInfo==null||accessToken==null) //访问的信息不存在，则返回空
            {
                alert("你还没有登录!");
                window.location.href = "login.html";
            }
            else {

                if (new Date().getTime()> tokenEndTime * 1000 )
                {
                    alert("登录授权时间超出!");
                    window.location.href = "login.html";

                }
                else
                {
//						alert(tokenEndTime * 1000+" "+new Date().getTime()+"已经登录成功了！"+userInfo);
                    var userType=userInfo.userType;
                    switch(userType[2])
                    {
                        case "3":  //用户为工程师，用户不能登录前端页面
                            alert("工程师不能登录前端!");
                            window.location.href = "login.html";
                            break;

                        case "2": //审批员只显示作业管理
                            $("#jizhanguanli").css('display','none');
                            $("#dianziyaoshiguanli").css('display','none');
                            $("#yuangongguanli").css('display','none');
                            break;

                        case "1": //管理员分五种情况
                            switch(userType[0])
                            {
                                case "1": //铁塔公司的管理员可以管理所有公司的员工

                                    break;
                                case "2": //中国移动工不能查看铁塔公司管理界面、中国联通公司管理界面、中国电信公司管理界面
                                    $("#ttyg").css('display','none'); //隐藏铁塔员工管理界面
                                    $("#ltyg").css('display','none'); //隐藏中国移动员工管理界面
                                    $("#dxyg").css('display','none'); //隐藏中国电信员工管理界面
                                    break;
                                case "3": //中国联通工不能查看铁塔公司管理界面、中国移动公司管理界面、中国电信公司管理界面
                                    $("#ttyg").css('display','none'); //隐藏铁塔员工管理界面
                                    $("#ydyg").css('display','none'); //隐藏中国移动员工管理界面
                                    $("#dxyg").css('display','none'); //隐藏中国电信员工管理界面
                                    break;
                                case "4": //中国电信工不能查看铁塔公司管理界面、中国移动公司管理界面、中国联通公司管理界面
                                    $("#ttyg").css('display','none'); //隐藏铁塔员工管理界面
                                    $("#ydyg").css('display','none'); //隐藏中国移动员工管理界面
                                    $("#ltyg").css('display','none'); //隐藏中国电信员工管理界面
                                    break;
                                case "5": //施工公司员工只能管理自己所属公司员工
                                    $("#ttyg").css('display','none'); //隐藏铁塔员工管理界面

                                    $("#ydyg").css('display','none'); //隐藏中国移动员工管理界面
                                    $("#ltyg").css('display','none'); //隐藏中国联通员工管理界面
                                    $("#dxyg").css('display','none'); //隐藏中国电信员工管理界面

                                    $("#dwgsyg").css('display','none');//隐藏代维公司员工管理界面
                                    $("#csyg").css('display','none');  //隐藏厂商员工管理界面
                                    $("#jizhanguanli").css('display','none'); //不能显示基站管理
                                    $("#dianziyaoshiguanli").css('display','none'); //不能显示电子钥匙管理
                                    break;
                                case "6": //代维公司员工只能管理自己所属公司员工
                                    $("#ttyg").css('display','none'); //隐藏铁塔员工管理界面

                                    $("#ydyg").css('display','none'); //隐藏中国移动员工管理界面
                                    $("#ltyg").css('display','none'); //隐藏中国联通员工管理界面
                                    $("#dxyg").css('display','none'); //隐藏中国电信员工管理界面

                                    $("#sggsyg").css('display','none');  //隐藏施工公司员工管理界面
                                    $("#csyg").css('display','none'); //隐藏厂商公司员工管理界面
                                    $("#jizhanguanli").css('display','none'); //不能显示基站管理
                                    $("#dianziyaoshiguanli").css('display','none'); //不能显示电子钥匙管理
                                    break;
                                case "7": //厂商公司员工只能管理自己所属公司员工
                                    $("#ttyg").css('display','none'); //隐藏铁塔公司员工管理界面

                                    $("#ydyg").css('display','none'); //隐藏中国移动员工管理界面
                                    $("#ltyg").css('display','none'); //隐藏中国联通员工管理界面
                                    $("#dxyg").css('display','none'); //隐藏中国电信员工管理界面

                                    $("#sggsyg").css('display','none'); //隐藏施工公司员工管理界面
                                    $("#dwgsyg").css('display','none'); //隐藏代维公司员工管理界面
                                    $("#jizhanguanli").css('display','none'); //不能显示基站管理
                                    $("#dianziyaoshiguanli").css('display','none'); //不能显示电子钥匙管理
                                    break;
                            }


                            break;
                    }

						showUserInformation(); //侧边栏显示当前用户公司 管理区域 职位 用户名

                        setup(); //初始化选择省市县框
                }
                //动态的显示登录人员名字
                document.getElementById("username1").innerHTML="欢迎回来"+" "+userInfo.username;

            }
            //获取数据并加载
            queryStation();
            setup(); //初始化选择省市县框

            var result=GetQueryString("result"); //获取地址栏中的username参数
            if(result=="success")
            {
                alert("文件上传成功！");
            }

        };


        function GetQueryString(key)
        {
            var lot = location.search;
            var reg = new RegExp(".*" + key + "\\s*=([^=&#]*)(?=&|#|).*","g");
            return decodeURIComponent(lot.replace(reg, "$1"));
        }

        //退出登录状态
        function  logout(){
            if(window.confirm("确定要退出登录状态？")){
                localStorage.clear();//清理登陆状态信息
                window.location.href="login.html";
            }
        }
        //新建基站
        function createStation(){
            //获取固定参数
            var operatorName=userInfo.username;
            var qsData="operatorName="+operatorName+"&accessToken="+accessToken;
            var stationInfo = "";
            //获取页面字段
            var stationID = $("#new_stationID").val();
            var address = $("#new_address").val();
            var doorStatus = $("#new_doorStatus").val();
            var lockID = $("#new_lockID").val();
            var chargePerson = $("#new_chargePerson").val();
            var chargePhone = $("#new_chargePhone").val();
            var chargeCompany = $("#new_chargeCompany").val();
            var managementProvince = $("#province").val();
            var managementCity = $("#city").val();
            var managementArea = $("#county").val();
            var approvalPerson = $("#new_approvalPerson").val();
            var approvalPhone = $("#new_approvalPhone").val();
            //对页面字段进行判空处理
            if (stationID==""||stationID==null){
                alert("基站编号不能为空，请重新填写！");
                $("#new_stationID").focus();
                $("#createStation").submit(function()
                {
                    return false;
                });
                return;
            }else{
                stationInfo = "&stationID="+stationID;
            };
            if(address==""||address==null){
                alert("基站地址不能为空，请重新填写！");
                $("#new_address").focus();
                $("#createStation").submit(function()
                {
                    return false;
                });
                return;
            }else {
                stationInfo=stationInfo+"&address="+address;
            };
            if(lockID==""||lockID==null){
                alert("基站门锁ID不能为空，请重新填写！");
                $("#new_lockID").focus();
                $("#createStation").submit(function()
                {
                    return false;
                });
                return;
            }else {
                stationInfo=stationInfo+"&lockID="+lockID;
            };
            if(chargePerson==""||chargePerson==null){
                alert("基站负责人不能为空，请重新填写！");
                $("#new_chargePerson").focus();
                $("#createStation").submit(function()
                {
                    return false;
                });
                return;
            }else {
                stationInfo=stationInfo+"&chargePerson="+chargePerson;
            };
            if(chargePhone==""||chargePhone==null){
                alert("负责人联系电话不能为空，请重新填写！");
                $("#new_chargePhone").focus();
                $("#createStation").submit(function()
                {
                    return false;
                });
                return;
            }else {
                stationInfo=stationInfo+"&chargePhone="+chargePhone;
            };
            if(chargeCompany==""||chargeCompany==null){
                alert("负责人公司不能为空，请重新填写！");
                $("#new_chargeCompany").focus();
                $("#createStation").submit(function()
                {
                    return false;
                });
                return;
            }else {
                stationInfo=stationInfo+"&chargeCompany="+chargeCompany;
            };
            if(managementProvince==""||managementProvince==null||managementProvince=="省份"){
                alert("所属省级地域不能为空，请重新填写！");
                $("#province").focus();
                $("#createStation").submit(function()
                {
                    return false;
                });
                return;
            }else {
                stationInfo=stationInfo+"&managementProvince="+managementProvince;
            };
            if(managementCity==""||managementCity==null||managementCity=="地级市"){
                alert("所属市级地域不能为空，请重新填写！");
                $("#county").focus();
                $("#createStation").submit(function()
                {
                    return false;
                });
                return;
            }else {
                stationInfo=stationInfo+"&managementCity="+managementCity;
            };
            if(managementArea==""||managementArea==null||managementArea=="市、县级市、县"){
                alert("所属区级地域不能为空，请重新填写！");
                $("#county").focus();
                $("#createStation").submit(function()
                {
                    return false;
                });
                return;
            }else {
                stationInfo=stationInfo+"&managementArea="+managementArea;
            };
            if(approvalPerson==""||approvalPerson==null){
                alert("基站作业审批人不能为空，请重新填写！");
                $("#new_approvalPerson").focus();
                $("#createStation").submit(function()
                {
                    return false;
                });
                return;
            }else {
                stationInfo=stationInfo+"&approvalPerson="+approvalPerson;
            };
            if(approvalPhone==""||approvalPhone==null){
                alert("作业审批人电话不能为空，请重新填写！");
                $("#new_approvalPhone").focus();
                $("#createStation").submit(function()
                {
                    return false;
                });
                return;
            }else {
                stationInfo=stationInfo+"&approvalPhone="+approvalPhone;
            };
            //判空结束
            //组合新建基站字段
            qsData = qsData+stationInfo;
//            console.log("新建基站信息为："+stationInfo);
            //发起请求
            $.ajax({
                async: false,
                url: "https://www.smartlock.top/v0/addStation",
                type: "POST",
                contentType: "application/x-www-form-urlencoded",
                data: qsData,
                timeout: 8000,
                beforeSend: function ()
                {

                },
                success: function (result) {

                    //将返回数据转化为json格式数据
                    var infoJson =JSON.parse(result);

                    //判断查询是否成功
                    if (infoJson.error){
                        var errInfo = infoJson.error;
                        alert(errInfo.msg);
                        $("#createStation").submit(function()
                        {
                            return false;
                        });
                        if(errInfo.code=="00000"){
                            window.location.href="login.html";
                        }
                    }else if (infoJson.success)
                    {
                        var sucInfo =  infoJson.success;
                        var msg = sucInfo.msg;
                        alert(msg);
                        clear_createStation();
                        $("#createStation").submit(function()
                        {
                            return false;
                        });
                    }else {
                        alert("未知错误，请联系管理员！")
                    }
                },
                error: function (result) {
//                    console.log(result);
                    alert("无法连接到服务器！");
                    $("#createStation").submit(function()
                    {
                        return false;
                    });
                }

            });
        };


        /**
         * 点击重置按钮
         */
        function reset(){
            $("#stationID").val("");
            $("#address").val("");
            $("#doorStatus").val("");
            $("#chargePerson").val("");
            $("#approvalPerson").val("");
        }
        //清空基站录入表单
        function clear_createStation(){
            $("#new_stationID").val("");
            $("#new_address").val("");
            $("#new_doorStatus").val("");
            $("#new_lockID").val("");
            $("#new_chargePerson").val("");
            $("#new_chargePhone").val("");
            $("#new_chargeCompany").val("");
            $("#new_approvalPerson").val("");
            $("#new_approvalPhone").val("");
        }
        //获取基站列表
        function queryStation(){
            var qsData = collectQueryInfo();
            //发起请求
            $.ajax({
                async: false,
                url: "https://www.smartlock.top/v0/queryStation",
                type: "POST",
                contentType: "application/x-www-form-urlencoded",
                data: qsData,
                timeout: 8000,
                beforeSend: function ()
                {

                },
                success: function (result) {

                    //将返回数据转化为json格式数据
                    var infoJson =JSON.parse(result);

                    //判断查询是否成功
                    if (infoJson.error){
                        var errInfo = infoJson.error;
                        alert(errInfo.msg);
                        $('#stationInfo').dataTable().fnClearTable();//清除表格内原有的数据
                        if(errInfo.code=="00000"){
                            window.location.href="login.html";
                        };
                        reset();
                        return;
                    }else if (infoJson.success)
                    {
                        var sucInfo =  infoJson.success;
                        var firstStationInfo =sucInfo[0];
                        var stationID = firstStationInfo.stationID;
                        $('#stationInfo').dataTable().fnClearTable();//清除表格内原有的数据
                        $('#stationInfo').dataTable().fnAddData(sucInfo,true);
                        reset();
                    }else {
                        alert("未知错误，请联系管理员！")
                    }


                },
                error: function (result) {
                    alert("无法连接到服务器！");
                }
            });
        };
        function collectQueryInfo(){
            //获取固定参数
            var operatorName=userInfo.username;
            var qsData="operatorName="+operatorName+"&accessToken="+accessToken;
            //获取查询参数
            var qsDataActive = "";
            var stationID = $("#stationID").val();
            var address = $("#address").val();
            var doorStatus = $("#doorStatus").val();
            var chargePerson = $("#chargePerson").val();
            var approvalPerson = $("#approvalPerson").val();
            if(stationID!=""&&stationID!=null){
                qsDataActive = "&stationID="+stationID
            }
            if(address!=""&&address!=null){
                qsDataActive = qsDataActive+"&address="+address
            }
            if(doorStatus!=""&&doorStatus!=null){
                qsDataActive = qsDataActive+"&doorStatus="+doorStatus
            }
            if(chargePerson!=""&&chargePerson!=null){
                qsDataActive = qsDataActive+"&chargePerson="+chargePerson
            }
            if(approvalPerson!=""&&approvalPerson!=null){
                qsDataActive = qsDataActive+"&approvalPerson="+approvalPerson
            }
            if (qsDataActive==""&&qsDataActive==null){
                return qsData
            }else{
                return qsData+qsDataActive;
            }
        }

        function validExcel()
        {
            // 获取上传文件名
//			 alert("进去函数体内")
            var excel_files = document.getElementById("file").files;
//            alert(document.getElementById("excel_file").files.length)
//            alert(document.getElementById("excel_file").files[1].name)
//            alert(excel_files.length);
            var flag=1;
            var upload_files="";
            if(excel_files.length<1)
            {
                alert("尚未选择文件!");
                flag=0;

            }

            for(var i=0;i<excel_files.length;i++)
            {
                var excel_name=excel_files[i].name;
                // 获取该文件名的后缀名
                var extend = excel_name.substring(excel_name.lastIndexOf(".") + 1);
//				 alert(i+" "+extend);

                if(extend!="xls"&&extend!="xlsx")
                {
                    alert("文件的后缀名不符合要求!文件名为"+excel_name);
                    falg=0;
                    break;
                }

                var file_name= excel_name.substring(excel_name.lastIndexOf("/") + 1);
                upload_files=upload_files+","+file_name;
            }


            if(flag==0)
            {
                return false;
            }
            else
            {

                return true;















            }

        }

        function synExcel()
        {

//            var excel_file = document.getElementById("excel_file").value;
//            if(excel_file==null||excel_file=="")
//            {
//                alert("您尚未上传基站数据文件！");
//                return ;
//            }

            var qsData="operatorName="+userInfo.username+"&accessToken="+accessToken+"&importDestination=0&filename=基站数据批量导入.xlsx";

            alert(qsData);
            //发起请求
            $.ajax({
                    async: false,
                    url: "https://www.smartlock.top/v0/importDataFromExcel",
                    type: "POST",
                    contentType: "application/x-www-form-urlencoded",
                    data: qsData,
                    timeout: 8000,
                    beforeSend: function ()
                    {

                    },
                    success: function (result) {

                        //将返回数据转化为json格式数据
                        var infoJson =JSON.parse(result);

                        //判断查询是否成功
                        if (infoJson.error){
                            var errInfo = infoJson.error;
                            alert(errInfo.msg);


                        }else if (infoJson.success)
                        {
                            var sucInfo =  infoJson.success;
                            alert(errInfo.msg);

                        }else {
                            alert("未知错误，请联系管理员！")
                        }

                        return true;

                    },
                    error: function (result) {
                        alert("无法连接到服务器！");
                    }
                });
        }

//        setInterval("myInterval()",10000);//1000为1秒钟，定时检查目前的token是否合法
//        function myInterval()
//        {
//            var query="operatorName="+userInfo.username+"&accessToken="+accessToken+"&username="+userInfo.username;
//            $.ajax({
//                async: false,
//                url: "https://www.smartlock.top/v0/queryUser",
//                type: "POST",
//                contentType: "application/x-www-form-urlencoded",
//                data: query,
//                timeout: 8000,
//                beforeSend: function ()
//                {
//
//                },
//                success: function (result) {
//                    //将返回数据转化为json格式数据
//                    var infoJson =JSON.parse(result);
//                    //判断查询是否成功
//                    if (infoJson.error){ //当前用户不存在或者当前用户token过期
//                        var errInfo = infoJson.error;
//                        alert(errInfo.msg);
//                        window.location.href="login.html";
//
//                        return;
//                    }else if (infoJson.success)
//                    {
////
////							console.log(accessToken)
//
//                    }else
//                    {
//                        alert("未知错误，请联系管理员！")
//                    }
//
//                },
//                error: function (result) {
////						console.log(result);
//                    alert("无法连接到服务器！");
//
//                }
//            });
//        }


        function showUserInformation() //侧边栏显示当前用户公司 管理区域 职位 用户名
        {
            var userType=userInfo.userType;

            switch(userType)
            {
                case "101":
                    document.getElementById("loginuser").innerHTML="<br>铁塔公司省级管理员<br>"+userInfo.username;
                    break;
                case "111":
                    document.getElementById("loginuser").innerHTML="<br>铁塔公司市级管理员<br>"+regionInfo.managementCity+" <br>"+userInfo.username;
                    break;
                case "121":
                    document.getElementById("loginuser").innerHTML="<br>铁塔公司区县管理员<br>"+regionInfo.managementCity+" "+regionInfo.managementArea+" <br>"+userInfo.username;
                    break;
                case "102":
                    document.getElementById("loginuser").innerHTML="<br>铁塔公司省级审批员<br>"+userInfo.username;
                    break;
                case "112":
                    document.getElementById("loginuser").innerHTML="<br>铁塔公司市级审批员<br>"+regionInfo.managementCity+" <br>"+userInfo.username;
                    break;
                case "122":
                    document.getElementById("loginuser").innerHTML="<br>铁塔公司区县审批员<br>"+regionInfo.managementCity+" "+regionInfo.managementArea+" <br>"+userInfo.username;
                    break;


                case "201":
                    document.getElementById("loginuser").innerHTML="<br>中国移动省级管理员<br>"+userInfo.username;
                    break;
                case "211":
                    document.getElementById("loginuser").innerHTML="<br>中国移动市级管理员<br>"+regionInfo.managementCity+" <br>"+userInfo.username;
                    break;
                case "221":
                    document.getElementById("loginuser").innerHTML="<br>中国移动区县管理员<br>"+regionInfo.managementCity+" "+regionInfo.managementArea+" <br>"+userInfo.username;
                    break;
                case "202":
                    document.getElementById("loginuser").innerHTML="<br>中国移动省级审批员<br>"+userInfo.username;
                    break;
                case "212":
                    document.getElementById("loginuser").innerHTML="<br>中国移动市级审批员<br>"+regionInfo.managementCity+" <br>"+userInfo.username;
                    break;
                case "222":
                    document.getElementById("loginuser").innerHTML="<br>中国移动区县审批员<br>"+regionInfo.managementCity+" "+regionInfo.managementArea+" <br>"+userInfo.username;
                    break;

                case "301":
                    document.getElementById("loginuser").innerHTML="<br>中国联通省级管理员<br>"+userInfo.username;
                    break;
                case "311":
                    document.getElementById("loginuser").innerHTML="<br>中国联通市级管理员<br>"+regionInfo.managementCity+" <br>"+userInfo.username;
                    break;
                case "321":
                    document.getElementById("loginuser").innerHTML="<br>中国联通区县管理员<br>"+regionInfo.managementCity+" "+regionInfo.managementArea+" <br>"+userInfo.username;
                    break;
                case "302":
                    document.getElementById("loginuser").innerHTML="<br>中国联通省级审批员<br>"+userInfo.username;
                    break;
                case "312":
                    document.getElementById("loginuser").innerHTML="<br>中国联通市级审批员<br>"+regionInfo.managementCity+" <br>"+userInfo.username;
                    break;
                case "322":
                    document.getElementById("loginuser").innerHTML="<br>中国联通区县审批员<br>"+regionInfo.managementCity+" "+regionInfo.managementArea+" <br>"+userInfo.username;
                    break;


                case "401":
                    document.getElementById("loginuser").innerHTML="<br>中国电信省级管理员<br>"+userInfo.username;
                    break;
                case "411":
                    document.getElementById("loginuser").innerHTML="<br>中国电信市级管理员<br>"+regionInfo.managementCity+" <br>"+userInfo.username;
                    break;
                case "421":
                    document.getElementById("loginuser").innerHTML="<br>中国电信区县管理员<br>"+regionInfo.managementCity+" "+regionInfo.managementArea+" <br>"+userInfo.username;
                    break;
                case "402":
                    document.getElementById("loginuser").innerHTML="<br>中国电信省级审批员<br>"+userInfo.username;
                    break;
                case "412":
                    document.getElementById("loginuser").innerHTML="<br>中国电信市级审批员<br>"+regionInfo.managementCity+" <br>"+userInfo.username;
                    break;
                case "422":
                    document.getElementById("loginuser").innerHTML="<br>中国电信区县审批员<br>"+regionInfo.managementCity+" "+regionInfo.managementArea+" <br>"+userInfo.username;
                    break;



                case "501":
                    document.getElementById("loginuser").innerHTML="<br>施工公司管理员<br>"+userInfo.username;
                    break;
                case "502":
                    document.getElementById("loginuser").innerHTML="<br>施工公司审批员<br>"+userInfo.username;
                    break;



                case "601":
                    document.getElementById("loginuser").innerHTML="<br>代维公司管理员<br>"+userInfo.username;
                    break;
                case "602":
                    document.getElementById("loginuser").innerHTML="<br>代维公司审批员<br>"+userInfo.username;
                    break;


                case "701":
                    document.getElementById("loginuser").innerHTML="<br>厂商管理员<br>"+userInfo.username;
                    break;
                case "702":
                    document.getElementById("loginuser").innerHTML="<br>厂商审批员<br>"+userInfo.username;
                    break;

            }

        }
    </script>
</head>

<body onload=checkUserValidity()>
<div style="height: inherit" id="body-wrapper"> <!-- Wrapper for the radial gradient background -->
    <!-- / flatty theme -->
    <script type="text/javascript" src="../assets/js/nav.js"></script>
    <div id="wrapper">
        <div id="main-nav-bg"></div>
        <!-- Logo (221px wide) -->
        <a href="#"><img id="logo" src="../assets/images/Logo_tower.png" alt="Simpla Admin logo" /></a>
        <!-- Sidebar Profile links -->
        <div id="profile-links">
            你好, <a href="#" title="Edit your profile" id="loginuser" class="loginuser" > </a><br />
            <br />
            <a href="#" class="mode2" title="View the Site">修改资料</a> | <a href="#" title="Sign Out" onclick="logout()">退出</a>
        </div>
        <nav id="main-nav" class="">
            <div class="navigation">
                <ul class="nav nav-stacked">
                    <li class="">
                        <a href="main_new.html">
                            <i class="icon-home"></i>
                            <span>首页</span>
                        </a>
                    </li><!--首页-->
                    <li class="active" id="jizhanguanli">
                        <a href="#" class="dropdown-collapse">
                            <i class="icon-rss"></i>
                            <span>基站管理</span>
                            <i class="icon-angle-down angle-down"></i>
                        </a>
                        <ul class="nav nav-stacked">
                            <li class="active">
                                <a href="stationManage_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>基站列表</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="stationManageLog_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>基站日志管理</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="stationUpload_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>基站批量导入</span>
                                </a>
                            </li>
                        </ul>
                    </li><!--基站管理-->
                    <li>
                        <a href="#" class="dropdown-collapse ">
                            <i class="icon-tasks"></i>
                            <span>作业管理</span>
                            <i class="icon-angle-down angle-down"></i>
                        </a>
                        <ul class="nav nav-stacked">
                            <li class="">
                                <a href="taskManage_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>工单列表</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="abnormalTaskManage_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>异常工单</span>
                                </a>
                            </li>
                        </ul>
                    </li><!--作业管理-->
                    <li id="dianziyaoshiguanli">
                        <a href="#" class="dropdown-collapse ">
                            <i class="icon-key"></i>
                            <span>电子钥匙管理</span>
                            <i class="icon-angle-down angle-down"></i>
                        </a>
                        <ul class="nav nav-stacked">
                            <li class="">
                                <a href="keyManage_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>钥匙列表</span>
                                </a>
                            </li>
                            <li class="">
                                <a href="keyManageLog_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>钥匙日志</span>
                                </a>
                            </li>
                        </ul>
                    </li><!--电子钥匙管理-->
                    <li id="yuangongguanli">
                        <a href="#" class="dropdown-collapse ">
                            <i class="icon-group"></i>
                            <span>员工管理</span>
                            <i class="icon-angle-down angle-down"></i>
                        </a>
                        <ul class="nav nav-stacked">
                            <div id="ttyg" class="specialdiv">
                                <li class="active">
                                <a href="tower_manager_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>铁塔公司</span>
                                </a>
                                </li>
                            </div><!--铁塔公司-->
                            <div id="ydyg" class="specialdiv">
                                <li class="">
                                <a href="mobile_manager_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>中国移动</span>
                                </a>
                            </li></div><!--中国移动-->
                            <div id="ltyg" class="specialdiv"><li class="">
                                <a href="unicom_manager_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>中国联通</span>
                                </a>
                            </li></div><!--中国联通-->
                            <div id="dxyg" class="specialdiv"><li class="">
                                <a href="telecom_manager_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>中国电信</span>
                                </a>
                            </li></div><!--中国电信-->
                            <div id="sggsyg" class="specialdiv"><li class="">
                                <a href="construction_manager_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>施工公司</span>
                                </a>
                            </li></div><!--施工公司-->
                            <div id="dwgsyg" class="specialdiv"> <li class="">
                                <a href="agent_manager_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>代维公司</span>
                                </a>
                            </li></div><!--代维公司-->
                            <div id="csyg" class="specialdiv"><li class="">
                                <a href="manufacturer_manager_new.html">
                                    <i class="icon-caret-right"></i>
                                    <span>厂商</span>
                                </a>
                            </li></div><!--厂商-->
                        </ul>
                    </li><!--员工管理-->
                </ul>
            </div>
        </nav>






    </div><!--导航栏-->
    <div id="main-content"> <!-- Main Content Section with everything -->
            <!-- Page Head -->
            <h2 id="username1"> </h2>
            <!--<p id="page-intro"></p>-->
            <div class="clear"></div> <!-- End .clear -->
            <div class="clear"></div> <!-- End .clear -->
            <div class="content-box"><!-- Start Content Box -->
            <div class="content-box-header">
                <!--<h3>内容模块</h3>-->
                <ul class="content-box-tabs">
                    <li><a class="default-tab" href="#stationList" >基站列表</a></li> <!-- href must be unique and match the id of target div -->
                    <li><a href="#createStation">基站录入</a></li>

                </ul>
                <div class="clear"></div>
            </div> <!-- End .content-box-header -->
            <!--弹出编辑框开始-->
            <div class="dialog">
                <div class="model-bg" title="editPersonInfo"></div>
                <div class="popBox" title="editPersonInfo">
                    <div class="ttBox">
                        <a class="clsBtn" title="editPersonInfo"></a>
                        <span class="tt">修改个人信息</span>
                    </div>
                    <div class="txtBox">
                        <div class="item">
                            <label for="editPerson_username">用户名：</label>
                            <input type="text" id="editPerson_username" disabled="true">
                        </div>
                        <div class="item">
                            <label for="editPerson_userType">用户类型：</label>
                            <input type="text" id="editPerson_userType" disabled="true">
                        </div>
                        <div class="item">
                            <label for="editPerson_company">用户所属公司：</label>
                            <input type="text" id="editPerson_company" disabled="true">
                        </div>
                        <div class="item">
                            <label for="editPerson_phone">手机号码：</label>
                            <input type="text" id="editPerson_phone" disabled="true">
                        </div>
                        <div class="item">
                            <label for="editPerson_originalPassword">原始密码：</label>
                            <input type="password" id="editPerson_originalPassword">
                        </div>
                        <div class="item">
                            <label for="editPerson_newPassword1">新密码：</label>
                            <input type="password" id="editPerson_newPassword1">
                        </div>
                        <div class="item">
                            <label for="editPerson_newPassword2">确认新密码：</label>
                            <input type="password" id="editPerson_newPassword2">
                        </div>
                    </div>
                    <div class="btnArea">
                        <div class="btnGroup">
                            <a class="sgBtn ok" id="submit_editPerson">确定</a>
                            <a class="sgBtn cancel" id="cancel_editPerson">取消</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="dialog" title="editOneStationInfo">
                <div class="model-bg" title="editOneStationInfo"></div>
                <div class="popBox" title="editOneStationInfo">
                    <div class="ttBox">
                        <a class="clsBtn" title="editOneStationInfo"></a>
                        <span class="tt">修改基站信息</span>
                    </div>
                    <div class="txtBox">
                        <div class="item">
                            <label for="edit_stationID">基站编号：</label>
                            <input type="text" id="edit_stationID">
                        </div>
                        <div class="item">
                            <label for="edit_address">基站地址：</label>
                            <input type="text" id="edit_address">
                        </div>
                        <div class="item">
                            <label for="edit_doorStatus">门锁状态：</label>
                            <select id="edit_doorStatus" class="edit_select">
                                <option value="">请选择门锁状态</option>
                                <option value="open">开启状态</option>
                                <option value="closed">关闭状态</option>
                            </select>

                            <!--<input type="text" id="edit_doorStatus">-->
                        </div>
                        <div class="item">
                            <label for="edit_lockID">门锁ID：</label>
                            <input type="text" id="edit_lockID">
                        </div>
                        <div class="item">
                            <label for="edit_chargePerson">负责人：</label>
                            <input type="text" id="edit_chargePerson">
                        </div>
                        <div class="item">
                            <label for="edit_approvalPerson">作业审批人：</label>
                            <input type="text" id="edit_approvalPerson">
                        </div>
                    </div>
                    <div class="btnArea">
                        <div class="btnGroup">
                            <a class="sgBtn ok" id="submit_editStationInfo">确定</a>
                            <a class="sgBtn cancel" id="cancel_editStationInfo">取消</a>
                        </div>
                    </div>
                </div>
            </div>
            <!--弹出编辑框结束-->
            <div class="content-box-content">
                <div class="tab-content default-tab" id="stationList"> 	<!-- This is the target div. id must match the href of this div's tab -->
                    <div class="queryCondition" id="queryStation">
                        <div class="screen-top">
                            <span>基站编号&nbsp;&nbsp;&nbsp;&nbsp;<input id="stationID" type="text"/></span>
                            <span>基站地址&nbsp;&nbsp;&nbsp;&nbsp;<input id="address" type="text" class="mh_date" /></span>
                            <span>门锁状态&nbsp;&nbsp;&nbsp;
                                <!--<input id="doorStatus" type="text" class="mh_date"  />-->
                                <select id="doorStatus" class="query_select">
                                    <option value="">请选择门锁状态</option>
                                    <option value="open">开启状态</option>
                                    <option value="closed">关闭状态</option>
                                </select>


                            </span>
                        </div>
                        <div class="screen-top">
                            <span>基站负责人<input id="chargePerson" type="text"/></span>
                            <span>作业审批人<input id="approvalPerson" type="text"  /></span>
                            <input class="button" id="query" type="submit" value="查询" onclick="queryStation()" />
                            <input class="button" id="reset" type="reset" value="重置" onclick="reset()"/>
                            <input class="button" id="exportxls" type="button" value="导出xls" />
                            <input class="button" id="delete" type="button" value="删除"/>
                            <!--<input class="button" id="createSation" type="button" value="新建基站"/>-->
                        </div>
                    </div>
                    <div>
                        <table class="display" id="stationInfo" cellspacing="0" width="100%">
                            <thead>
                            <tr>
                                <th><input type="checkbox" id="allcheck" name="allChecked" /></th>
                                <th>基站编号</th>
                                <th>基站地址</th>
                                <th>门锁状态</th>
                                <th>门锁ID</th>
                                <th>负责人</th>
                                <!--<th>负责人电话</th>-->
                                <!--<th>负责人公司</th>-->
                                <th>所属省级</th>
                                <th>所属市级</th>
                                <th>所属区级</th>
                                <th>作业审批人</th>
                                <!--<th>作业审批人电话</th>-->
                                <th>操作</th>
                            </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div> <!-- End #stationList -->
                <div class="tab-content" id="createStation">

                    <form action="" method="post">

                        <fieldset id="createStationFieldSet" > <!-- Set class to "column-left" or "column-right" on fieldsets to divide the form into columns -->
                            <p>
                                <strong><font color="red">*</font> 基站编号：</strong>
                                <input class="text-input small-input" type="text" id="new_stationID" name="new_stationID" />
                            </p>
                            <p>
                                <strong> <font color="red">*</font> 基站地址： </strong>
                                <input class="text-input small-input" type="text" id="new_address" name="new_address" />
                            </p>
                            <p>
                                <strong> <font color="red">*</font> 基站门锁状态： </strong>

                                <select id="new_doorStatus" class="add_select">
                                    <option value="">请选择门锁状态</option>
                                    <option value="open">开启状态</option>
                                    <option value="closed">关闭状态</option>
                                </select>

                                <!--<input class="text-input small-input" type="text" id="new_doorStatus" name="new_doorStatus" />-->
                            </p>
                            <p>
                                <strong> <font color="red">*</font> 门锁ID： </strong>
                                <input class="text-input small-input" type="text" id="new_lockID" name="new_lockID" />
                            </p>
                            <p>
                                <strong> <font color="red">*</font> 负责人： </strong>
                                <input class="text-input small-input" type="text" id="new_chargePerson" name="new_chargePerson" />
                            </p>
                            <p>
                                <strong> <font color="red">*</font> 负责人电话： </strong>
                                <input class="text-input small-input" type="text" id="new_chargePhone" name="new_chargePhone" />
                            </p>
                            <p>
                                <strong> <font color="red">*</font> 负责人公司： </strong>
                                <input class="text-input small-input" type="text" id="new_chargeCompany" name="new_chargeCompany" />
                            </p>
                            <p>
                                <strong> <font color="red">*</font> 所属地区： </strong>
                                <select name="province" id="province"></select>
                                <select name="city" id="city"></select>
                                <select name="county" id="county"></select>


                            </p>
                            <p>
                                <strong> <font color="red">*</font> 作业审批人： </strong>
                                <input class="text-input small-input" type="text" id="new_approvalPerson" name="new_approvalPerson" />
                            </p>
                            <p>
                                <strong> <font color="red">*</font> 作业审批人电话： </strong>
                                <input class="text-input small-input" type="text" id="new_approvalPhone" name="new_approvalPhone" />
                            </p>
                            <p>
                                <input class="button" type="submit" value="提交" onclick="createStation()"/>
                            </p>

                        </fieldset>

                        <div class="clear"></div><!-- End .clear -->

                    </form>

                </div> <!-- End #stationLog -->





            </div> <!-- End .content-box-content -->

        </div> <!-- End .content-box -->
            <div id="footer">
                <!-- Remove this notice or replace it with whatever you want -->
                &#169; Copyright 2016 中国铁塔股份有限公司 | Powered by UESTC CSIS</a> | <a href="#top">Top</a>
            </div><!-- End #footer -->
        </div>
</div>
</body>

</html>
 